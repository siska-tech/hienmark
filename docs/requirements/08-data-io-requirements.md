# データ入出力要件

## 8. データ入出力・外部連携要件

このセクションは、HienMarkのデータの可搬性（Import/Export）や外部サービスとの連携に関する要件を定義する。優先度は【低】だが、将来的な機能拡張の基盤として重要である。

---

### 8.1 データエクスポート機能

#### REQ-DAT-001: データエクスポート機能 ⏳ 未実装

**要件概要:**
REQ-ARC-001 (SQLite) に保存されたタスクデータを、標準的なフォーマットでエクスポートする。

**機能要件:**
- FR-4.1.1.1 (CSV): 現在のビュー（または全タスク）をCSV形式でエクスポートする
- FR-4.1.1.2 (JSON): 全タスクデータをJSON形式（スキーマ定義必須）でエクスポートする

**受入基準:**
- AC-4.1.1.1: エクスポートされたCSVファイルをExcel等で開くことができ、文字化け（特に日本語）が発生しない

**実装状況:** ⏳ 未実装（優先度: 低）

**依存関係:** REQ-ARC-001 (SQLite化) の完了後に実装可能

---

### 8.2 タグ入出力機能

#### REQ-DAT-002: タグI/O機能 ⏳ 未実装

**要件概要:**
ユーザーが定義したタグ（名称、色、属性）をエクスポートおよびインポートする。

**機能要件:**
- FR-4.1.2.1 (エクスポート): タグ定義をJSON形式でエクスポートできる
- FR-4.1.2.2 (インポート): エクスポートされたタグ定義JSONファイルをインポートし、タグ設定を復元できる
- FR-4.1.2.3 (競合解決): 既存のタグと同名のタグをインポートする際の競合解決方法を選択できる（上書き/スキップ/マージ）

**受入基準:**
- AC-4.1.2.1: 他のHienMarkプロジェクトで作成したタグ定義（JSON）を、新規プロジェクトでインポートして再利用できる

**実装状況:** ⏳ 未実装（優先度: 低）

---

### 8.3 高度なタグ属性機能

#### REQ-TAG-001: 特殊データ型サポート ⏳ 未実装

**要件概要:**
タスクのメタデータ（タグ属性）として、単純なテキスト以外の特殊なデータ型をサポートする。

**対象データ型:**

| データ型 | 説明 | 実装状況 |
|---------|------|---------|
| Currency (通貨) | 数値入力と通貨記号（JPY, USD等） | ⏳ 未実装 |
| Image (画像) | REQ-EDT-004と同様のアセットアップロード機能 | ⏳ 未実装 |
| Hyperlink | URLの妥当性検証を含むリンク入力欄 | ⏳ 未実装 |

**機能要件:**
- FR-4.2.1.1 (専用UI): 各データ型に対応する専用の入力UIコンポーネントを実装する
  - **Currency**: 数値入力フィールド + 通貨ドロップダウン
  - **Image**: 画像アップロード/プレビュー/削除ボタン
  - **Hyperlink**: URLと説明テキストの入力フィールド

**Currency型の詳細:**
- `min` (最小値), `max` (最大値)
- `decimalPlaces` (小数点以下の桁数)
- `defaultValue` (既定値)
- `currencyFormat` (通貨形式の選択, 例: JPY, USD)

**受入基準:**
- AC-4.2.1.1: タスクに「見積額」タグ（Currency型）を追加し、数値と通貨を入力・保存できる
- AC-4.2.1.2: タスクに「サムネイル」タグ（Image型）を追加し、画像をアップロード・表示できる
- AC-4.2.1.3: タスクに「参照URL」タグ（Hyperlink型）を追加し、リンクを保存・クリックして開ける

**実装状況:** ⏳ 未実装（優先度: 低）

**注記:**
基本的なタグ属性（String, Number, Boolean, Datetime, Select, MultiSelect）は既に実装済み（[04-advanced-features.md](04-advanced-features.md#41-タグ属性システム-typed-tagging-system--75-実装完了) 参照）。本要件は高度なデータ型の追加実装。

---

### 8.4 外部Gitサービス連携

#### REQ-API-001: GitHub/GitLab PR連携 ⏳ 未実装

**要件概要:**
REQ-GIT-001の拡張として、ローカルのGit操作に加え、GitHub/GitLabとAPI連携し、プルリクエスト（PR）の情報をHienMark上で表示・操作する。

**機能要件:**
- FR-4.3.1.1 (認証): GitHub/GitLabのPersonal Access Token（PAT）を用いたAPI認証機能を実装する
- FR-4.3.1.2 (PR作成支援): REQ-GIT-003でのコミット後、PR作成を補助するUIを提供する
- FR-4.3.1.3 (ステータス表示): ブランチ（REQ-GIT-001）に関連付けられたPRのステータス（Open, Merged, CI/CD Status）をHienMarkのタスク詳細画面に表示する

**受入基準:**
- AC-4.3.1.1: ユーザーがHienMark上で、feature/Aブランチのタスクが、現在GitHub上でPRレビュー中であることを確認できる
- AC-4.3.1.2: HienMarkからGitHub PRを作成し、PRのURLをタスクに自動的に関連付けることができる

**実装状況:** ⏳ 未実装（優先度: 低）

**依存関係:**
- REQ-GIT-001 (ブランチスコープ機能)
- REQ-GIT-003 (Gitコミット操作UI)

**セキュリティ考慮事項:**
- PATは暗号化してローカルストレージに保存
- API通信はHTTPS必須
- スコープは最小限（`repo`または`read:org`のみ）

---

## 実装状況サマリー

| データI/O要件 | 完成度 | 備考 |
|--------------|--------|------|
| REQ-DAT-001: データエクスポート | 0% | 未実装（優先度: 低） |
| REQ-DAT-002: タグI/O | 0% | 未実装（優先度: 低） |
| REQ-TAG-001: 特殊データ型 | 0% | 未実装（優先度: 低） |
| REQ-API-001: GitHub/GitLab連携 | 0% | 未実装（優先度: 低） |

**全体平均:** 0%（Phase 7以降の実装予定）

---

## 参照

- [機能要件](02-functional-requirements.md)
- [高度な機能](04-advanced-features.md)
- [実装ロードマップ](10-implementation-roadmap.md)
