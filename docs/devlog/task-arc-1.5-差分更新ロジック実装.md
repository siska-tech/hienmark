---
status: completed
priority: high
assignee: BE
start_date: 2025-11-21
end_date: 2025-11-23
tags: ["アーキテクチャ", "REQ-ARC-001", "実装", "Rust", "パフォーマンス"]
depends_on: []
---

# Task-ARC-1.5: インデックスの差分更新ロジック（mtime比較）実装

## 概要

起動時に全ファイルをスキャンするのではなく、変更があったファイルのみを再パースしてインデックスを差分更新する機能を実装する。

## タスク詳細

### 実装要件

- ファイルの最終更新日時（mtime）とSQLite内の最終インデックス日時を比較
- 変更があったファイル**のみ**を再パース
- インデックスを「差分更新」

### 実装方針

- `file_metadata`テーブルの`mtime`とファイルシステムの`mtime`を比較
- 不一致の場合のみ再パース
- バッチ処理による効率化

### パフォーマンス目標

- 10,000ファイルでの起動時間を500ms未満に抑える（NFR-2.1.1.1）

### チェックリスト

- [ ] mtime比較ロジック実装
- [ ] 差分更新ロジック実装
- [ ] バッチ処理実装
- [ ] パフォーマンステスト（10,000ファイル）
- [ ] エラーハンドリング
- [ ] ログ機能（どのファイルが更新されたか）

## メモ

- 大規模プロジェクトでの起動速度向上が目的
- ファイルシステムのmtime取得のコストを考慮



