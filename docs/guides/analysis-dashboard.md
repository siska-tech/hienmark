# 分析ダッシュボードガイド

## 概要

HienMarkの分析ダッシュボードは、ワークスペース内のタスクデータを視覚的に分析・可視化する強力な機能です。EChartsを使用した高機能なチャートにより、プロジェクトの進捗状況、タグの分布、依存関係などを一目で把握できます。

## 分析ダッシュボードを開く

1. ワークスペースを開いた状態で、ヘッダーの「**分析**」ボタンをクリック
2. 分析ダッシュボードが表示されます
3. 「タスク表示」ボタンで通常のタスク表示に戻れます

## チャートタイプ

分析ダッシュボードでは、4種類のチャートタイプを切り替えて表示できます。

### ガントチャート

タスクのスケジュールと依存関係を可視化します。

**表示内容:**
- タスクの開始日・終了日
- タスク間の依存関係（矢印で接続）
- 進捗状況（塗りつぶしの割合）
- 循環依存の検出（警告表示）

**設定項目:**
- **開始日フィールド**: タスクの開始日として使用するタグ（例: `start_date`, `created`）
- **終了日フィールド**: タスクの終了日として使用するタグ（例: `due_date`, `end_date`）
- **進捗フィールド**: 進捗率として使用するタグ（例: `progress`, `completion`）
- **依存関係フィールド**: 依存関係として使用するタグ（例: `depends_on`, `blocks`）

**使用例:**
プロジェクトのマイルストーン管理に最適です。各タスクの開始日と終了日を設定し、依存関係を定義することで、プロジェクト全体のスケジュールを可視化できます。

### パイチャート

タグ分布を円グラフで表示します。

**表示内容:**
- カテゴリ別のタスク数の分布
- 値別のタスク数の分布
- 割合の表示

**設定項目:**
- **集約フィールド**: 集約するタグカテゴリ（例: `status`, `priority`）
- **表示形式**: カテゴリ別または値別の表示

**使用例:**
- `status` カテゴリで集約すると、ステータス別のタスク数の割合を確認できます
- `priority` カテゴリで集約すると、優先度別のタスク数の割合を確認できます

### バーチャート

カテゴリ別統計を棒グラフで表示します。

**表示内容:**
- カテゴリ別のタスク数の集計
- 時系列での集計（日別、週別、月別）
- 値別の集計

**設定項目:**
- **集約フィールド**: 集約するタグカテゴリ
- **集約方法**: カウント、平均、合計など
- **時系列オプション**: 日別、週別、月別の集計

**使用例:**
- 月別のタスク作成数の推移を確認
- カテゴリ別のタスク数の比較
- 優先度別のタスク数の可視化

### 折れ線グラフ

時系列データの推移を折れ線グラフで表示します。

**表示内容:**
- 時系列でのタスク数の推移
- 複数のカテゴリの比較
- トレンドの可視化

**設定項目:**
- **時系列フィールド**: 時系列として使用するタグ（例: `created`, `updated`）
- **集約フィールド**: 集約するタグカテゴリ
- **期間**: 表示する期間（日別、週別、月別）

**使用例:**
- タスク作成数の時系列推移
- ステータス別のタスク数の推移
- プロジェクトの進捗状況の可視化

## 表示モード

分析ダッシュボードには、3つの表示モードがあります。

### プレビューモード

生成されたMermaidダイアグラムコードをプレビュー表示します。

- Mermaid記法で記述されたダイアグラムがそのまま表示されます
- インタラクティブな操作はできませんが、ダイアグラムの確認に便利です

### ソースモード

生成されたMermaidダイアグラムコードのソースを表示します。

- Mermaid記法のコードを直接確認・編集できます
- コピーして他のツールで使用することもできます

### EChartsモード（推奨）

EChartsによる高機能なインタラクティブチャートを表示します。

- マウスオーバーで詳細情報を表示
- ズーム・パン操作が可能
- データポイントのクリックでタスク詳細を表示
- 最も高機能な表示モードです

## 日付範囲フィルター

分析ダッシュボードでは、グローバルな日付範囲フィルターを設定できます。

### フィルター設定

1. ダッシュボード上部の「日付範囲フィルター」セクションを開く
2. **日付フィールド**を選択（例: `created`, `updated`, `due_date`）
3. **開始日**と**終了日**を設定
4. フィルターが自動的に適用されます

### 日付フィールドの種類

- **作成日**: タスクファイルの作成日時
- **更新日**: タスクファイルの最終更新日時
- **カスタムタグ**: 任意の日付タグ（例: `start_date`, `due_date`）

### 使用例

- 過去1ヶ月のタスクのみを分析
- 特定の期間に作成されたタスクの進捗を確認
- 期限が近いタスクのみを可視化

## 依存関係分析

ガントチャートでは、タスク間の依存関係を自動的に分析します。

### 循環依存の検出

タスク間に循環依存（A → B → C → A）がある場合、警告が表示されます。

**表示内容:**
- 循環依存のパスの表示
- 警告メッセージ
- 影響を受けるタスクの一覧

**対処方法:**
1. 循環依存のパスを確認
2. 不要な依存関係を削除
3. 依存関係の構造を見直す

### 依存関係の設定

タスクのFront Matterで `depends_on` タグを使用して依存関係を定義します：

```yaml
---
id: task-001
title: タスク1
depends_on: [task-002, task-003]
---
```

この例では、`task-001` は `task-002` と `task-003` に依存しています。

## タスク詳細表示

チャート上のデータポイントをクリックすると、タスクの詳細情報が表示されます。

### タスク詳細モーダル

**表示内容:**
- タスクID
- タスクタイトル（最初の見出し）
- 全てのタグ情報
- タスクファイルのパス
- 「エディタで開く」ボタン

**操作:**
- 「エディタで開く」ボタンをクリックすると、該当タスクがエディタで開きます
- モーダル外をクリックまたはEscキーで閉じます

## チャート設定の永続化

分析ダッシュボードの設定は自動的に保存されます。

**保存場所:**
- `.hienmark/analysis_settings.json`

**保存される設定:**
- 選択中のチャートタイプ
- チャートのマッピング設定
- 日付範囲フィルターの設定
- 表示モード

次回ダッシュボードを開いた際、前回の設定が自動的に復元されます。

## 実用的な使用例

### 例1: プロジェクト進捗の可視化

**シナリオ**: プロジェクト全体の進捗状況を一目で把握したい

1. ガントチャートを選択
2. 開始日フィールド: `start_date`、終了日フィールド: `due_date` を設定
3. 進捗フィールド: `progress` を設定
4. 依存関係フィールド: `depends_on` を設定
5. プロジェクト全体のスケジュールと進捗が可視化されます

### 例2: ステータス分布の確認

**シナリオ**: タスクのステータス分布を確認したい

1. パイチャートを選択
2. 集約フィールド: `status` を設定
3. ステータス別のタスク数の割合が円グラフで表示されます
4. マウスオーバーで詳細情報を確認できます

### 例3: タスク作成数の推移

**シナリオ**: 月別のタスク作成数の推移を確認したい

1. 折れ線グラフを選択
2. 時系列フィールド: `created` を設定
3. 期間: 月別を選択
4. 過去数ヶ月のタスク作成数の推移が折れ線グラフで表示されます

### 例4: 優先度別のタスク管理

**シナリオ**: 優先度別にタスクを管理したい

1. バーチャートを選択
2. 集約フィールド: `priority` を設定
3. 優先度別のタスク数が棒グラフで表示されます
4. 高優先度のタスクが多すぎる場合は、タスクの優先度を見直すことができます

## データのエクスポート

現在、チャートデータのエクスポート機能は実装中です。将来的には以下の形式でのエクスポートが可能になる予定です：

- **PNG形式**: チャートの画像として保存
- **SVG形式**: ベクター形式での保存
- **JSON形式**: チャートデータのエクスポート
- **CSV形式**: データテーブルのエクスポート

## パフォーマンス

分析ダッシュボードは、大量のタスクデータでも高速に動作します。

**最適化機能:**
- データのメモ化による不要な再計算の防止
- 段階的なデータ読み込み
- 計算済みデータのキャッシュ

**推奨環境:**
- タスク数が1000を超える場合は、日付範囲フィルターを使用して表示範囲を絞ることをお勧めします

## トラブルシューティング

### チャートが表示されない

- ワークスペースが正しく開かれているか確認
- タスクに適切なタグが設定されているか確認
- ブラウザの開発者ツール（F12）でエラーがないか確認

### データが正しく表示されない

- タグの形式が正しいか確認（日付タグは `YYYY-MM-DD` 形式）
- 依存関係タグの形式が正しいか確認（配列形式: `[task-001, task-002]`）
- 日付範囲フィルターの設定を確認

### パフォーマンスが遅い

- 日付範囲フィルターを使用して表示範囲を絞る
- 不要なチャートタイプへの切り替えを避ける
- ワークスペース内のタスク数を確認

## 次のステップ

- [タグ管理機能ガイド](tag-management.md) - タグの管理と設定
- [テンプレート機能ガイド](tag-templates.md) - タグテンプレートの使い方
- [ワークスペース管理ガイド](workspace-management.md) - ワークスペースの基本操作

